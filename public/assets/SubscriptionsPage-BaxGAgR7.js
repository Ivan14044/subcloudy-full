import{u as s,a as t,b as i,c as e,e as n,_ as c}from"./index-CY44GJdZ.js";import{u as a}from"./alert-D7KfH9V3.js";import{d as r,r as o,o as u,c as l,l as p,m as v,n as d,t as b,x as _,v as m,F as g,G as f,q as y}from"./vendor-vue-hI7Tl2YZ.js";import{u as h}from"./vendor-i18n-DgmEITMB.js";import"./vendor-ui-C1W_zwwL.js";const $={class:"subscriptions-page"},w={class:"subscriptions-header"},x={class:"subscriptions-title"},k={class:"subscriptions-tabs"},C={key:0,class:"subscriptions-list"},S={class:"subscription-content"},T={class:"subscription-info"},j=["textContent"],M=["textContent"],D=["innerHTML"],H={class:"subscription-meta"},L={class:"subscription-meta"},U={key:0,class:"subscription-meta"},F=["innerHTML"],q={class:"subscription-logo-wrapper"},A=["src","alt"],G={key:0,class:"subscription-actions"},I={class:"subscription-status-badge"},P={key:0,class:"subscription-action-wrapper"},R=["onClick"],Y={key:1,class:"subscriptions-empty"},z=c(r({__name:"SubscriptionsPage",setup(c){const r=s(),z=t(),{locale:B,t:E}=h(),{showConfirm:J}=a();i();const K=o("active"),N=e(),O=n();function Q(s){var t,i;const e=N.services.find(t=>t.id===s);return(null==(i=null==(t=null==e?void 0:e.translations)?void 0:t[B.value])?void 0:i.name)??`#${s}`}function V(s){var t,i;const e=N.services.find(t=>t.id===s);return(null==(i=null==(t=null==e?void 0:e.translations)?void 0:t[B.value])?void 0:i.subtitle)??null}function W(s){const t=N.services.find(t=>t.id===s);return(null==t?void 0:t.logo)??""}function X(s){const t=N.services.find(t=>t.id===s);return(null==t?void 0:t.amount.toFixed(2))??""}u(()=>{var s,t,i;(null==(t=null==(s=r.user)?void 0:s.subscriptions)?void 0:t.length)||r.fetchUser(),(null==(i=N.services)?void 0:i.length)||N.fetchData()});const Z=l(()=>{var s,t;return(null==(t=null==(s=r.user)?void 0:s.subscriptions)?void 0:t.length)?r.user.subscriptions.filter(s=>"active"===K.value?"active"===s.status:"active"!==s.status):[]}),ss=function(s){const t=new Date(s);return`${String(t.getDate()).padStart(2,"0")}.${String(t.getMonth()+1).padStart(2,"0")}.${t.getFullYear()}`};return(s,t)=>(v(),p("div",$,[d("div",w,[d("h1",x,_(s.$t("subscriptions.title")),1),d("div",k,[d("button",{class:m(["subscriptions-tab",{"subscriptions-tab--active":"active"===K.value}]),onClick:t[0]||(t[0]=s=>K.value="active")},_(s.$t("subscriptions.active_tab")),3),d("button",{class:m(["subscriptions-tab",{"subscriptions-tab--active":"inactive"===K.value}]),onClick:t[1]||(t[1]=s=>K.value="inactive")},_(s.$t("subscriptions.inactive_tab")),3)])]),Z.value.length?(v(),p("div",C,[(v(!0),p(g,null,f(Z.value,t=>{var i;return v(),p("div",{key:t.id,class:"subscription-item"},[d("div",S,[d("div",T,[d("h3",{class:m(["subscription-service-name",{"subscription-service-name--no-subtitle":null===V(t.service_id)}]),textContent:_(s.$t("subscriptions.title_sub",{name:Q(t.service_id)}))},null,10,j),V(t.service_id)?(v(),p("h4",{key:0,class:"subscription-service-subtitle",textContent:_(V(t.service_id))},null,8,M)):b("",!0),d("p",{class:"subscription-price",innerHTML:s.$t("plans.price_monthly",{price:X(t.service_id),currency:((null==(i=y(O).options)?void 0:i.currency)||"USD").toUpperCase()})},null,8,D),d("p",H,_(s.$t("subscriptions.payment_method",{method:s.$t("checkout."+t.payment_method)})),1),d("p",L,_(s.$t("subscriptions.created_at",{date:ss(t.created_at)})),1),"credit_card"===t.payment_method&&"active"===t.status?(v(),p(g,{key:1},[t.is_auto_renew?(v(),p("p",U,_(s.$t("subscriptions.next_payment_at",{date:ss(t.next_payment_at)})),1)):(v(),p("p",{key:1,class:"subscription-meta",innerHTML:s.$t("subscriptions.end_at",{date:ss(t.next_payment_at)})},null,8,F))],64)):b("",!0)]),d("div",q,[d("img",{src:W(t.service_id),alt:Q(t.service_id),class:"subscription-logo"},null,8,A)])]),"active"===t.status?(v(),p("div",G,[d("div",{class:m(["subscription-status-wrapper","active"===t.status&&"credit_card"===t.payment_method?"subscription-status-wrapper--half":"subscription-status-wrapper--full"])},[d("span",I,_(s.$t("subscriptions.status_"+t.status)),1)],2),"active"===t.status&&"credit_card"===t.payment_method?(v(),p("div",P,[d("button",{type:"button",class:"subscription-action-button",onClick:s=>async function(s,t){const i=1===t;if((await J({title:E(i?"subscriptions.toggle_confirm_title_cancel":"subscriptions.toggle_confirm_title_renew"),text:E(i?"subscriptions.toggle_confirm_text_cancel":"subscriptions.toggle_confirm_text_renew"),confirmText:E("subscriptions.toggle_confirm_yes"),cancelText:E("subscriptions.toggle_confirm_no")})).isConfirmed)try{await r.toggleAutoRenew(s),await r.fetchUser(),z.success(E("subscriptions.toggled_success"))}catch(e){z.error(E("subscriptions.toggled_error"))}}(t.id,t.is_auto_renew)},_(t.is_auto_renew?s.$t("subscriptions.cancel"):s.$t("subscriptions.renew")),9,R)])):b("",!0)])):b("",!0)])}),128))])):b("",!0),Z.value.length?b("",!0):(v(),p("p",Y,_("active"===K.value?s.$t("subscriptions.empty_active"):s.$t("subscriptions.empty_inactive")),1))]))}}),[["__scopeId","data-v-d0ffe584"]]);export{z as default};
