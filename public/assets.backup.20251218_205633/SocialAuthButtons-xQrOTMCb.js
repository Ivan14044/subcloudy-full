import{d as e,u as t,E as s,l as a,m as r,n as o,x as n}from"./vendor-vue-hI7Tl2YZ.js";import{u as i,_ as l}from"./index-m-gYk0xz.js";const c={class:"flex flex-col space-y-4 mt-6"},d={class:"relative"},g={class:"relative flex justify-center text-sm"},m={class:"separator"},u={class:"flex flex-col gap-3"},p={class:"text-white"},h=l(e({__name:"SocialAuthButtons",setup(e){const l=i(),h=t(),w=s(),y=()=>{const e="\n    toolbar=no,\n    location=no,\n    status=no,\n    menubar=no,\n    scrollbars=yes,\n    resizable=yes,\n    width=800,\n    height=600\n  ",t=window.open("/auth/google/reauth","googleAuth",e.replace(/\s+/g,"")),s=async e=>{if(e.origin===window.location.origin)if("GOOGLE_AUTH_SUCCESS"===e.data.type){const{token:t,user:a}=e.data.data;l.setToken(t),l.setUser(a),window.removeEventListener("message",s);const r=w.query.redirect;h.push(r||"/")}else"GOOGLE_AUTH_ERROR"===e.data.type&&window.removeEventListener("message",s)};window.addEventListener("message",s);const a=setInterval(()=>{(null==t?void 0:t.closed)&&(window.removeEventListener("message",s),clearInterval(a))},1e3)},v=()=>{window.Telegram?x():f()},f=()=>{if(document.getElementById("telegram-login-script"))return;const e=document.createElement("script");e.id="telegram-login-script",e.src="https://telegram.org/js/telegram-widget.js",e.async=!0,e.onload=x,document.head.appendChild(e)},x=()=>{window.Telegram&&window.Telegram.Login&&window.Telegram.Login.auth({bot_id:"8267596067"},e=>{e&&b(e)})},b=async e=>{try{const t=await fetch("/auth/telegram/callback",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(e)});if(!t.ok){await t.text();throw new Error(`Server error: ${t.status} ${t.statusText}`)}const s=await t.json();if(s.token){l.setToken(s.token),l.setUser(s.user);const e=w.query.redirect;h.push(e||"/")}}catch(t){}};return(e,t)=>(r(),a("div",c,[o("div",d,[t[0]||(t[0]=o("div",{class:"absolute inset-0 flex items-center"},[o("div",{class:"w-full border-t border-gray-200"})],-1)),o("div",g,[o("span",m,n(e.$t("auth.orContinueWith")),1)])]),o("div",u,[o("a",{class:"flex items-center dark:text-white dark:hover:bg-gray-300 dark:hover:text-gray-800 justify-center border border-gray-300 rounded-lg px-4 py-3 hover:bg-gray-50 transition-colors cursor-pointer",onClick:y},[t[1]||(t[1]=o("img",{class:"w-5 h-5 mr-2",src:"/img/google.png",alt:"google",width:"20",height:"20",style:{"aspect-ratio":"1 / 1"}},null,-1)),o("span",null,n(e.$t("auth.google")),1)]),o("button",{class:"flex items-center justify-center border-[#1a94d2] rounded-lg px-4 py-3 bg-[#1a94d2] hover:bg-[#1a94d2]/80 transition-colors",onClick:v},[t[2]||(t[2]=o("img",{class:"w-5 h-5 mr-2",src:"/img/telegram.png",alt:"telegram",width:"20",height:"20",style:{"aspect-ratio":"1 / 1"}},null,-1)),o("span",p,n(e.$t("auth.telegram")),1)])])]))}}),[["__scopeId","data-v-59002130"]]);export{h as S};
