import{n as e,i as a,A as t}from"./index-m-gYk0xz.js";import{d as r,E as i,u as s,c as l,o,w as n,l as d,m as u,n as c,t as g,f as v,x as m,F as y,G as p,p as b,v as f}from"./vendor-vue-hI7Tl2YZ.js";import{_ as h}from"./BackLink.vue_vue_type_script_setup_true_lang-Cj7yD4M1.js";import{u as x}from"./vendor-i18n-DgmEITMB.js";import"./vendor-ui-C1W_zwwL.js";const k={class:"max-w-7xl mx-auto px-4 py-16 sm:px-6 lg:px-8 relative"},w={class:"flex items-start justify-between mt-6 mb-10"},N=["innerHTML"],M={key:0,class:"mt-3 text-gray-600 dark:text-gray-300"},$=["innerHTML"],q={key:0},_={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-8 xl:gap-6"},P={class:"flex items-center justify-center gap-2 mt-10"},j=["disabled"],S=["disabled","onClick"],A=["disabled"],C=r({__name:"ArticlesAll",setup(r){const{t:C,locale:I}=x(),F=e(),L=a(),T=i(),H=s(),U=l(()=>Number(T.query.limit??12)),B=l(()=>Number(T.query.offset??0)),z=l(()=>{const e=void 0!==T.params.page?Number(T.params.page):void 0;if("number"==typeof e&&Number.isFinite(e)&&e>=1)return e;const a=Math.max(1,Number(U.value)||12),t=Math.max(0,Number(B.value)||0);return Math.floor(t/a)+1}),E=l(()=>{const e=Math.max(1,Number(U.value)||12);return(z.value-1)*e}),G=l(()=>{const e=void 0!==T.params.id?Number(T.params.id):void 0;if("number"==typeof e&&Number.isFinite(e))return e;const a=void 0!==T.query.category_id?Number(T.query.category_id):void 0;return"number"==typeof a&&Number.isFinite(a)?a:void 0});l(()=>{var e,a;const t=Number((null==(e=F.paginatedParams)?void 0:e.offset)??0),r=Math.max(1,Number((null==(a=F.paginatedParams)?void 0:a.limit)??U.value)||12);return Math.floor(t/r)});const D=l(()=>void 0!==T.params.id),J=l(()=>"number"==typeof G.value?F.getCategoryById(G.value):void 0),K=l(()=>{var e,a;const t=J.value;if(!t)return"";return(null==(a=null==(e=t.translations)?void 0:e[I.value])?void 0:a.name)??t.name??""}),O=l(()=>G.value&&K.value||String(C("articles.title"))),Q=l(()=>{var e;const a=J.value;if(!a)return"";const t=null==(e=a.translations)?void 0:e[I.value],r=null==t?void 0:t.text;if("string"!=typeof r)return"";const i=r.trim();return i.length>0?i:""});async function R(){await F.fetchArticlesPage({limit:U.value,offset:E.value,categoryId:G.value})}o(async()=>{F.hasCachedPage({limit:U.value,offset:E.value,categoryId:G.value})||L.start();try{if(void 0!==T.query.offset||void 0!==T.query.limit){const e={...T.query};delete e.offset,delete e.limit,delete e.category_id;const a=z.value,t=void 0!==T.params.id,r=a<=1?t?`/categories/${T.params.id}`:"/articles":t?`/categories/${T.params.id}/page/${a}`:`/articles/page/${a}`;await H.replace({path:r,query:e})}F.loaded.categories||await F.fetchCategories(),await R(),requestAnimationFrame(()=>{try{if("1"===sessionStorage.getItem("articlesUsedSavedPosition"))return void sessionStorage.removeItem("articlesUsedSavedPosition")}catch(e){}window.scrollTo({top:0,left:0,behavior:"smooth"})})}finally{L.stop()}}),n([U,E,G],()=>{!async function(){F.hasCachedPage({limit:U.value,offset:E.value,categoryId:G.value})||L.start();try{await R(),requestAnimationFrame(()=>{try{if("1"===sessionStorage.getItem("articlesUsedSavedPosition"))return void sessionStorage.removeItem("articlesUsedSavedPosition")}catch(e){}window.scrollTo({top:0,left:0,behavior:"smooth"})})}finally{L.stop()}}()});const V=l(()=>F.getLocalizedPaginatedArticles(I.value)),W=l(()=>F.paginatedTotal),X=l(()=>{const e=Math.max(1,Number(U.value)||12),a=Math.max(0,Number(W.value)||0);return Math.max(1,Math.ceil(a/e))}),Y=l(()=>L.isLoading),Z=l(()=>{var e,a;const t=z.value,r=Math.max(1,Number((null==(e=F.paginatedParams)?void 0:e.limit)??U.value)||12),i=Math.max(0,Number((null==(a=F.paginatedParams)?void 0:a.offset)??0)||0),s=Math.floor(i/r)+1;return t===s?t:s}),ee=l(()=>{const e=X.value,a=Z.value;return e<=6?Array.from({length:e},(e,a)=>a+1):a<=3?[1,2,3,"...",e]:a>=e-2?[1,"...",e-2,e-1,e]:[1,"...",a-1,a,a+1,"...",e]});function ae(){const e=Math.max(1,Z.value-1),a="number"==typeof G.value,t=e<=1?a?`/categories/${G.value}`:"/articles":a?`/categories/${G.value}/page/${e}`:`/articles/page/${e}`,r={...T.query};delete r.offset,delete r.limit,delete r.category_id,H.push({path:t,query:r})}function te(){const e=Math.min(X.value,Z.value+1),a="number"==typeof G.value,t=e<=1?a?`/categories/${G.value}`:"/articles":a?`/categories/${G.value}/page/${e}`:`/articles/page/${e}`,r={...T.query};delete r.offset,delete r.limit,delete r.category_id,H.push({path:t,query:r})}return(e,a)=>(u(),d("div",k,[c("div",w,[c("div",null,[c("h1",{class:"text-2xl font-medium md:text-4xl md:font-light text-dark dark:text-white",innerHTML:O.value},null,8,N),D.value?Q.value?(u(),d("div",{key:1,class:"mt-3 text-gray-600 dark:text-gray-300",innerHTML:Q.value},null,8,$)):g("",!0):(u(),d("p",M,m(e.$t("articles.description")),1))]),v(h,{class:"self-start"})]),V.value.length>0?(u(),d("div",q,[c("div",_,[(u(!0),d(y,null,p(V.value,e=>(u(),b(t,{key:e.id,title:e.title,excerpt:e.excerpt,categories:e.categories,"image-url":e.img??"/img/no-logo.png",href:`/articles/${e.id}`,date:e.dateString,short:e.short},null,8,["title","excerpt","categories","image-url","href","date","short"]))),128))]),c("div",P,[Z.value>1?(u(),d("button",{key:0,class:"inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border border-gray-300 dark:!border-gray-600/60 text-sm text-gray-700 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-400/30 transition disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",disabled:Y.value,onClick:ae,"aria-label":"Previous page"}," ← ",8,j)):g("",!0),(u(!0),d(y,null,p(ee.value,e=>(u(),d("button",{key:`p-${e}`,class:f(["inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border text-sm transition min-w-[40px] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",["..."===e?"cursor-default border-transparent text-gray-400":e===Z.value?"border-gray-900 bg-gray-900 text-white dark:!bg-gray-300 dark:!text-gray-900 dark:!border-gray-600/60":"border-gray-300 dark:!border-gray-600/60 text-gray-700 dark:!text-white hover:bg-gray-200 dark:hover:bg-gray-400/30"]]),disabled:"..."===e||Y.value,onClick:a=>"..."!==e&&function(e){if(!Number.isFinite(e)||e<1||e>X.value)return;const a="number"==typeof G.value,t=e<=1?a?`/categories/${G.value}`:"/articles":a?`/categories/${G.value}/page/${e}`:`/articles/page/${e}`,r={...T.query};delete r.offset,delete r.limit,delete r.category_id,H.push({path:t,query:r})}(Number(e))},m(e),11,S))),128)),Z.value<X.value?(u(),d("button",{key:1,class:"inline-flex items-center justify-center leading-none px-3 py-1.5 rounded border border-gray-300 dark:!border-gray-600/60 text-sm text-gray-700 dark:text-white hover:bg-gray-200 dark:hover:bg-gray-400/30 transition disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent disabled:hover:dark:bg-transparent",disabled:Y.value,onClick:te,"aria-label":"Next page"}," → ",8,A)):g("",!0)])])):g("",!0)]))}});export{C as default};
