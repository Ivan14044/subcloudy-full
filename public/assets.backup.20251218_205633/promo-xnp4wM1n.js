import{k as s}from"./vendor-vue-hI7Tl2YZ.js";import{g as e}from"./index-m-gYk0xz.js";import"./vendor-i18n-DgmEITMB.js";import"./vendor-ui-C1W_zwwL.js";const t=s("promo",{state:()=>({code:"",loading:!1,error:"",result:null,lastAppliedAt:null}),actions:{async apply(s){var t,o,r,i;const l=(s||"").trim();if(l){this.loading=!0,this.error="",this.result=null;try{const{data:s}=await e.post("/promocodes/validate",{code:l});"discount"===(null==s?void 0:s.type)?(this.code=l,this.result={type:"discount",discount_percent:Number(s.discount_percent||0)}):"free_access"===(null==s?void 0:s.type)?(this.code=l,this.result={type:"free_access",services:Array.isArray(s.services)?s.services:[]}):this.error=(null==s?void 0:s.message)||"Invalid promocode",this.lastAppliedAt=Date.now()}catch(n){const s=null==(o=null==(t=null==n?void 0:n.response)?void 0:t.data)?void 0:o.status,e=null==(i=null==(r=null==n?void 0:n.response)?void 0:r.data)?void 0:i.message;this.error=e||(s?`Promocode ${s}`:"Invalid promocode")}finally{this.loading=!1}}else this.error=""},clear(){this.code="",this.error="",this.result=null,this.lastAppliedAt=null}},persist:!0});export{t as usePromoStore};
