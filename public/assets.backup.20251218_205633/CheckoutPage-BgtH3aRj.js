import{d as e,c as t,l as a,m as r,F as s,G as l,n as o,v as i,f as c,q as n,x as d,C as u,t as p,r as m,w as v,I as g,u as h,o as x,J as b,H as y,p as f,W as k,X as w,A,a2 as _,B as j,z as C}from"./vendor-vue-hI7Tl2YZ.js";import{d as M,e as F,_ as T,a as S,u as U,i as B,j as D,g as G}from"./index-m-gYk0xz.js";import{u as Z}from"./alert-D7KfH9V3.js";import{usePromoStore as $}from"./promo-xnp4wM1n.js";import{T as V,X as I,h as N}from"./vendor-ui-C1W_zwwL.js";import{u as H}from"./vendor-i18n-DgmEITMB.js";import{_ as W}from"./BackLink.vue_vue_type_script_setup_true_lang-Cj7yD4M1.js";function P(e,t="ru"){switch(t){case"ru":{const t=e%10,a=e%100;return 1===t&&11!==a?`${e} день`:t>=2&&t<=4&&(a<10||a>=20)?`${e} дня`:`${e} дней`}case"uk":{const t=e%10,a=e%100;return 1===t&&11!==a?`${e} день`:t>=2&&t<=4&&(a<10||a>=20)?`${e} дні`:`${e} днів`}case"en":return 1===e?`${e} day`:`${e} days`;case"es":return 1===e?`${e} día`:`${e} días`;case"zh":return`${e} 天`;default:return`${e} days`}}const z={class:"flex flex-col gap-6 w-full"},O=["disabled","onClick"],R={class:"flex items-start gap-4 text-dark dark:text-white"},Y=["src","alt"],E={class:"flex-1 space-y-2"},L={class:"text-lg sm:text-xl"},q={class:"text-sm"},J=["innerHTML"],K={class:"mt-4 grid grid-cols-1 text-dark dark:text-white sm:grid-cols-2 gap-4"},Q=["onClick"],X={class:"flex justify-between items-start xl:items-center"},ee={class:"xl:flex xl:items-center xl:gap-2"},te={class:"text-xs px-2 py-1 bg-orange-400 !text-gray-950 rounded-lg"},ae={class:"text-right xl:flex xl:items-center"},re={class:"text-lg font-bold"},se={class:"text-xs text-dark dark:text-white xl:ml-2"},le=["onClick"],oe={class:"flex justify-between items-start xl:items-center"},ie={class:"xl:flex xl:items-center xl:gap-2"},ce={class:"text-xs px-2 py-1 bg-green-400 !text-gray-950 rounded-lg"},ne={class:"text-right xl:flex xl:items-center"},de={class:"text-lg font-bold"},ue={class:"text-xs text-dark dark:text-white xl:ml-2"},pe={key:0,class:"absolute -top-3 -left-3 bg-green-500 text-white text-xs px-2 py-1 rounded-md shadow"},me=T(e({__name:"ServiceList",setup(e){const m=M(),v=$(),g=F(),{locale:h,t:x}=H(),{showConfirm:b}=Z(),y=t(()=>{var e;try{const t=(null==(e=g.options)?void 0:e.currency)||"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:t,minimumFractionDigits:0,maximumFractionDigits:2})}catch(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:2})}}),f=(e,t)=>{var a,r;return(null==(a=e.translations[h.value])?void 0:a[t])??(null==(r=e.translations.en)?void 0:r[t])??null},k=(e,t)=>{const a=m.getSubscriptionType(e)===t;return"trial"===t?["plan-card cursor-pointer rounded-lg p-3 relative border-2",a?"border-orange-400 bg-orange-400/10":"border-transparent glass-card hover:border-orange-400/50"]:["plan-card cursor-pointer rounded-lg p-3 relative border-2",a?"border-green-400 bg-green-400/10":"border-transparent glass-card hover:border-green-400/50"]},w=e=>m.isFree(e)&&!!v.code&&!!v.result&&"free_access"===v.result.type;return(e,t)=>(r(),a("div",z,[(r(!0),a(s,null,l(n(m).items,s=>{var l;return r(),a("div",{key:s.id,class:"service-card transition-all duration-300 glass-card rounded-3xl p-4 sm:p-6 relative"},[o("button",{type:"button",class:i(["absolute top-4 right-4 w-9 h-9 rounded-full glass-button flex items-center justify-center transition-colors duration-200 hover:bg-red-500 text-dark dark:text-white hover:text-white",w(s.id)?"opacity-50 cursor-not-allowed hover:bg-transparent hover:text-current":""]),disabled:w(s.id),onClick:e=>!w(s.id)&&(async e=>{(await b({title:x("cart.confirm.remove_single.title"),text:x("cart.confirm.remove_single.text"),confirmText:x("cart.confirm.remove_single.confirm"),cancelText:x("cart.confirm.remove_single.cancel")})).isConfirmed&&m.removeFromCart(e)})(s.id)},[c(n(V),{class:"w-4"})],10,O),o("div",R,[o("img",{src:s.logo,alt:`${f(s,"name")} Logo`,width:"80",height:"80",class:"w-16 h-16 sm:w-20 sm:h-20 flex-shrink-0 object-contain",style:{"aspect-ratio":"1 / 1"}},null,8,Y),o("div",E,[o("h3",L,d(f(s,"name")),1),o("p",q,d(f(s,"subtitle")),1),o("p",{class:"text-sm mt-1",innerHTML:f(s,"short_description_checkout")},null,8,J)])]),o("div",K,[o("div",{class:i(["plan-card rounded-lg p-3 relative border-2",[k(s.id,"trial"),n(m).isFree(s.id)?"opacity-50 pointer-events-none cursor-not-allowed":"cursor-pointer"]]),onClick:e=>!n(m).isFree(s.id)&&n(m).setSubscriptionType(s.id,"trial")},[o("div",X,[o("div",ee,[t[0]||(t[0]=o("div",{class:"text-lg"},"Trial",-1)),o("div",te,d(e.$t("checkout.trial_badge")),1)]),o("div",ae,[o("div",re,d(y.value&&y.value.format?n(m).isFree(s.id)?y.value.format(0):y.value.format(s.trial_amount):"0.00"),1),o("div",se,[t[1]||(t[1]=o("span",{class:"hidden xl:!inline-flex mr-1"}," / ",-1)),u(" "+d(n(P)((null==(l=n(g).options)?void 0:l.trial_days)||3,n(h))),1)])])])],10,Q),o("div",{class:i(["plan-card cursor-pointer rounded-lg p-3 relative border-2",k(s.id,"premium")]),onClick:e=>!n(m).isFree(s.id)&&n(m).setSubscriptionType(s.id,"premium")},[o("div",oe,[o("div",ie,[t[2]||(t[2]=o("div",{class:"text-lg"},"Premium",-1)),o("div",ce,d(e.$t("checkout.premium_badge")),1)]),o("div",ne,[o("div",de,d(y.value&&y.value.format?n(m).isFree(s.id)?y.value.format(0):y.value.format(s.amount):"0.00"),1),o("div",ue,[t[3]||(t[3]=o("span",{class:"hidden xl:!inline-flex mr-1"}," / ",-1)),u(d(e.$t("perMonth")),1)])])]),n(m).isFree(s.id)?(r(),a("div",pe,d(e.$t("checkout.free_via_promocode",{days:n(m).promoFreeDays[s.id]||0})),1)):p("",!0)],10,le)])])}),128))]))}}),[["__scopeId","data-v-cbfbcecf"]]),ve={class:"space-y-3 text-dark dark:text-white"},ge={class:"flex items-center gap-3 w-100"},he={class:"flex-1"},xe={class:"font-medium"},be={class:"text-xs"},ye={class:"mt-2 flex items-center gap-2"},fe={class:"icon-pill",title:"Apple Pay"},ke=["src"],we={class:"icon-pill",title:"Google Pay"},Ae=["src"],_e={class:"icon-pill",title:"Visa"},je=["src"],Ce={class:"icon-pill",title:"Mastercard"},Me=["src"],Fe={class:"ml-auto"},Te={class:"flex items-center gap-3 w-100"},Se={class:"flex-1"},Ue={class:"font-medium"},Be={class:"text-xs"},De={class:"mt-2 flex items-center gap-2"},Ge={class:"icon-pill",title:"Bitcoin"},Ze=["src"],$e={class:"icon-pill",title:"Ethereum"},Ve=["src"],Ie={class:"icon-pill",title:"Tether"},Ne=["src"],He={class:"ml-auto"},We=T(e({__name:"PaymentList",props:{modelValue:{},disabled:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:s}){const l=e,c=s,u=m(l.modelValue),p=M();v(()=>l.modelValue,e=>{u.value=e});const h=t(()=>p.items.some(e=>"trial"===p.getSubscriptionType(e.id))),x=e=>{l.disabled||(u.value=e,c("update:modelValue",e))},b=e=>["payment-method cursor-pointer rounded-lg p-4 border-2 flex items-center gap-3",u.value===e?"border-blue-400 bg-blue-400/10":"border-transparent glass-card hover:border-blue-400/50",h.value&&"crypto"===e?"opacity-50 pointer-events-none":"",l.disabled?"opacity-50 pointer-events-none":""];return(e,t)=>(r(),a("div",ve,[o("div",{class:i(b("card")),onClick:t[0]||(t[0]=e=>x("card"))},[o("div",ge,[t[2]||(t[2]=g('<div class="w-10 h-10 rounded flex items-center justify-center" data-v-955972ec><svg width="28" height="20" viewBox="0 0 28 20" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-955972ec><rect x="0.5" y="1" width="27" height="18" rx="3" stroke="currentColor" stroke-opacity="0.9" data-v-955972ec></rect><rect x="3" y="6" width="8" height="2" rx="1" fill="currentColor" fill-opacity="0.9" data-v-955972ec></rect><rect x="3" y="10" width="5" height="2" rx="1" fill="currentColor" fill-opacity="0.9" data-v-955972ec></rect></svg></div>',1)),o("div",he,[o("div",xe,d(e.$t("checkout.credit_card")),1),o("div",be,d(e.$t("checkout.credit_card_placeholder")),1),o("div",ye,[o("div",fe,[o("img",{src:n("data:image/png;base64,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"),alt:"Apple Pay",width:"40",height:"16",class:"h-3 object-contain object-center",style:{"aspect-ratio":"5 / 2"}},null,8,ke)]),o("div",we,[o("img",{src:n("/assets/Google_Pay_Logo.svg-h4Y4vlz0.png"),alt:"google pay",width:"40",height:"16",class:"h-3 object-contain object-center",style:{"aspect-ratio":"5 / 2"}},null,8,Ae)]),o("div",_e,[o("img",{src:n("/assets/VISA-logo-Bv4jiMXy.png"),alt:"Visa",width:"40",height:"16",class:"h-4 object-contain object-center",style:{"aspect-ratio":"5 / 2"}},null,8,je)]),o("div",Ce,[o("img",{src:n("/assets/mastercard-logo-BRj9UBQ9.png"),alt:"mastercard",width:"40",height:"24",class:"h-4 object-contain object-center",style:{"aspect-ratio":"5 / 3"}},null,8,Me)])])]),o("div",Fe,[o("div",{class:i(["w-4 h-4 rounded-full border-2 transition-all duration-300","card"===u.value?"border-blue-400 bg-blue-400":"border-gray-800 dark:border-gray-100"])},null,2)])])],2),o("div",{class:i(b("crypto")),onClick:t[1]||(t[1]=e=>x("crypto"))},[o("div",Te,[t[3]||(t[3]=o("div",{class:"w-10 h-10 rounded flex items-center justify-center"},[o("span",{class:"text-xl"},"₿")],-1)),o("div",Se,[o("div",Ue,d(e.$t("checkout.crypto")),1),o("div",Be,d(e.$t("checkout.crypto_placeholder")),1),o("div",De,[o("div",Ge,[o("img",{src:n("/assets/Bitcoin.svg-CDsAdeWD.png"),alt:"bitcoin",width:"24",height:"24",class:"h-4 object-contain object-center",style:{"aspect-ratio":"1 / 1"}},null,8,Ze)]),o("div",$e,[o("img",{src:n("/assets/Ethereum_logo_translucent-BMe2KU8-.png"),alt:"ethereum",width:"24",height:"24",class:"h-4 object-contain object-center",style:{"aspect-ratio":"1 / 1"}},null,8,Ve)]),o("div",Ie,[o("img",{src:n("/assets/tether-logo-v-ijRJKZ.png"),alt:"tether",width:"24",height:"24",class:"h-4 object-contain object-center",style:{"aspect-ratio":"1 / 1"}},null,8,Ne)])])]),o("div",He,[o("div",{class:i(["w-4 h-4 rounded-full border-2 transition-all duration-300","crypto"===u.value?"border-blue-400 bg-blue-400":"border-gray-800 dark:border-gray-100"])},null,2)])])],2)]))}}),[["__scopeId","data-v-955972ec"]]),Pe={class:"max-w-7xl mx-auto px-4 py-16 sm:px-6 lg:px-8 relative z-1"},ze={key:0,class:"mx-auto grid gap-8 lg:grid-cols-[minmax(0,1fr)_24rem]"},Oe={class:"flex items-center justify-between mt-6 mb-2 lg:col-span-2"},Re={class:"text-2xl font-medium md:text-4xl md:font-light text-dark dark:text-white"},Ye={class:"min-w-0"},Ee={class:"w-full lg:max-w-sm text-dark dark:text-white font-normal space-y-6"},Le={class:"glass-card rounded-3xl p-6 relative overflow-hidden"},qe={class:"space-y-4"},Je={class:"space-y-2"},Ke={class:"flex justify-between items-center"},Qe={class:"font-normal"},Xe={key:0,class:"flex justify-between items-center text-sm"},et={key:1,class:"flex justify-between items-center text-sm"},tt={key:2,class:"flex justify-between items-center"},at={class:"font-normal"},rt={class:"font-normal"},st={class:"space-y-2"},lt={class:"flex items-stretch gap-0"},ot=["placeholder","disabled"],it=["disabled","aria-label"],ct={class:"mt-3 rounded-lg overflow-hidden glass-card"},nt={class:"px-3 py-2"},dt={class:"flex items-center justify-between gap-3"},ut={class:"text-left text-xs text-dark dark:text-white leading-snug"},pt={class:"font-medium"},mt={key:0,class:"mt-3 rounded-lg overflow-hidden glass-card"},vt={class:"px-3 py-2"},gt={class:"text-xs text-dark dark:text-white font-medium mb-1"},ht={class:"font-medium"},xt={class:"ml-2"},bt={key:0,class:"mt-3 rounded-lg overflow-hidden glass-card"},yt={class:"px-3 py-2"},ft={class:"flex items-center justify-between gap-3"},kt={class:"text-left text-xs text-dark dark:text-white leading-snug"},wt={class:"whitespace-pre-line"},At={class:"px-2 py-0.5 bg-green-500 text-white rounded-xl text-sm font-semibold"},_t={class:"glass-card rounded-3xl p-6"},jt={class:"font-normal mb-4"},Ct=["disabled"],Mt={key:1,class:"min-h-[30vh] grid place-items-center"},Ft={class:"w-full max-w-md mx-auto px-4"},Tt=["innerHTML"],St={class:"flex items-center gap-3 mb-4"},Ut={class:"text-xs dark:text-gray-100"},Bt={class:"glass-card rounded-3xl p-4 relative overflow-hidden text-dark dark:text-white"},Dt={class:"font-normal mb-2"},Gt={class:"flex items-stretch gap-0"},Zt=["placeholder","disabled"],$t=["disabled","aria-label"],Vt=T(e({__name:"CheckoutPage",setup(e){const u=h(),g=S(),{showAlert:T}=Z(),{locale:V,t:P}=H(),z=M(),O=U(),R=B(),Y=F(),E=$(),L=m(""),q=m("");let J=null;const K=t(()=>!!E.code&&!!E.result&&!E.error&&E.code===q.value),Q=t(()=>z.items.length>0),X=t(()=>z.items.length),ee=t(()=>{if(!Y.options)return 0;const e=Number(Y.options.discount_2||0),t=Number(Y.options.discount_3||0);return X.value>=3?t>0?t:0:2===X.value&&e>0?e:0}),te=t(()=>z.subtotalPaid),ae=t(()=>te.value*ee.value/100),re=t(()=>{var e;return"discount"===(null==(e=E.result)?void 0:e.type)?Number(E.result.discount_percent||0):0}),se=t(()=>te.value*re.value/100),le=t(()=>Math.max(0,te.value-ae.value-se.value)),oe=t(()=>0===le.value&&z.items.length>0),ie=t(()=>{if(!Y.options)return 0;const e=Number(Y.options.discount_2||0),t=Number(Y.options.discount_3||0);return 1===X.value?e>0?e:0:2===X.value&&t>0?t:0}),ce=e=>{var t;const a=((null==(t=Y.options)?void 0:t.currency)||"USD").toUpperCase();return`${e.toFixed(2)} ${a}`},ne=t(()=>{if(!L.value)return[];const e=new Date;return z.items.map(t=>{let a;return a="trial"===z.getSubscriptionType(t.id)?pe(e,3):ve(e,1),{id:t.id,name:ue(t,"name"),date:ge(a)}})}),de=t(()=>z.items.some(e=>"trial"===z.getSubscriptionType(e.id))),ue=(e,t)=>{var a,r;return(null==(a=e.translations[V.value])?void 0:a[t])??(null==(r=e.translations.en)?void 0:r[t])??null},pe=(e,t)=>{const a=new Date(e.getTime());return a.setDate(a.getDate()+t),a},ve=(e,t)=>{const a=new Date(e.getTime());return a.setMonth(a.getMonth()+t),a},ge=e=>`${String(e.getDate()).padStart(2,"0")}.${String(e.getMonth()+1).padStart(2,"0")}.${e.getFullYear()}`,he=t(()=>{const e=[];return z.trialServicesCount>0&&e.push(`${z.trialServicesCount} ${P("checkout.trial_services")}`),z.premiumServicesCount>0&&e.push(`${z.premiumServicesCount} ${P("checkout.premium_services")}`),e.join(", ")});x(()=>{R.stop(),E.code&&E.result&&(q.value=E.code,"free_access"===E.result.type&&0===z.promoFreeIds.length&&z.applyFreeAccessServices(E.result.services||[])),window.addEventListener("pageshow",e=>{const t=performance.getEntriesByType("navigation")[0];(e.persisted||"back_forward"===(null==t?void 0:t.type))&&R.stop()}),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&R.stop()});"true"===new URLSearchParams(window.location.search).get("success")&&(z.clearCart(),E.clear(),u.replace({path:"/"}).then(()=>{g.success(P("checkout.success"))}))});const xe=async()=>{oe.value?await fe():"card"===L.value?await be():"crypto"===L.value&&await ye()};v(oe,e=>{e&&(L.value="")});const be=async()=>{var e,t;R.start();try{const e={services:z.items.map(e=>e.id),subscriptionTypes:z.subscriptionTypes,...E.code?{promocode:E.code}:{}},{data:t}=await G.post("/mono/create-payment",e,{headers:{Authorization:`Bearer ${O.token}`}});t.url?window.location.href=t.url:(R.stop(),g.error(P("checkout.payment_error")))}catch(a){const r=a&&(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||P("checkout.payment_error");g.error(r),R.stop()}},ye=async()=>{var e,t;R.start();try{const e={services:z.items.map(e=>e.id),...E.code?{promocode:E.code}:{}},{data:t}=await G.post("/cryptomus/create-payment",e,{headers:{Authorization:`Bearer ${O.token}`}});t.url?window.location.href=t.url:(R.stop(),g.error(P("checkout.payment_error")))}catch(a){const r=a&&(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||P("checkout.payment_error");g.error(r),R.stop()}},fe=async()=>{var e,t;try{await z.submitCart({paymentMethod:"free",promocode:E.code||void 0}),await O.fetchUser(),E.clear(),q.value="",g.success(P("checkout.free_success")),await u.push("/")}catch(a){const r=a&&(null==(t=null==(e=a.response)?void 0:e.data)?void 0:t.message)||P("checkout.payment_error");g.error(r)}};function ke(){K.value?(E.clear(),z.removeFreeAccessServices(),q.value=""):async function(){J&&clearTimeout(J),J=window.setTimeout(async()=>{var e,t;await E.apply(q.value),E.error?await T({title:P("alert.title"),text:E.error,icon:"error",confirmText:P("alert.ok")}):"free_access"===(null==(e=E.result)?void 0:e.type)?await z.applyFreeAccessServices(E.result.services||[]):"discount"===(null==(t=E.result)?void 0:t.type)&&0===z.items.length&&await T({title:P("alert.title"),text:P("checkout.promocode_discount_empty_cart"),icon:"success",confirmText:P("alert.ok")})},500)}()}return(e,t)=>{const u=b("i18n-t");return r(),a("div",Pe,[Q.value?(r(),a("div",ze,[o("div",Oe,[o("h1",Re,d(e.$t("checkout.title")),1),c(W)]),o("div",Ye,[o("form",{class:"space-y-6",onSubmit:y(xe,["prevent"])},[c(me)],32)]),o("div",Ee,[o("div",Le,[o("div",qe,[o("div",Je,[o("div",Ke,[o("h3",Qe,d(ee.value>0||re.value>0?e.$t("checkout.original_total"):e.$t("checkout.total_amount"))+": ",1),o("span",{class:i([ee.value>0||re.value>0?"line-through opacity-60":"","font-normal"])},d(ce(te.value)),3)]),ee.value>0?(r(),a("div",Xe,[o("span",null,d(e.$t("checkout.discount"))+" ("+d(ee.value)+"%)",1),o("span",null,"-"+d(ce(ae.value)),1)])):p("",!0),re.value>0?(r(),a("div",et,[o("span",null,d(e.$t("checkout.promocode_discount"))+" ("+d(re.value)+"%)",1),o("span",null,"-"+d(ce(se.value)),1)])):p("",!0),ee.value>0||re.value>0?(r(),a("div",tt,[o("h3",at,d(e.$t("checkout.total_amount"))+":",1),o("span",rt,d(ce(le.value)),1)])):p("",!0)]),o("div",st,[o("div",lt,[k(o("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>q.value=e),placeholder:e.$t("checkout.promocode_placeholder"),class:i(["flex-1 h-11 px-3 border rounded-l-lg rounded-r-none",K.value?"!border-green-400 !bg-green-400/10":"!border-gray-700 dark:!border-gray-300"]),disabled:K.value},null,10,ot),[[w,q.value,void 0,{trim:!0}]]),o("button",{class:i(["h-11 w-12 grid place-items-center border border-l-0 rounded-r-lg rounded-l-none transition-all text-white disabled:opacity-50",K.value?"border-red-500 bg-red-500 hover:bg-red-600 dark:border-red-700 dark:bg-red-900 dark:hover:bg-red-800":"border-blue-500 bg-blue-500 hover:bg-blue-600 dark:border-blue-700 dark:bg-blue-900 dark:hover:bg-blue-800"]),disabled:n(E).loading||!K.value&&!q.value,"aria-label":K.value?e.$t("checkout.promocode_clear_aria"):e.$t("checkout.promocode_apply_aria"),onClick:y(ke,["prevent"])},[K.value?(r(),f(n(I),{key:0,class:"w-5 h-5"})):(r(),f(n(N),{key:1,class:"w-5 h-5"}))],10,it)])]),o("div",ct,[o("div",nt,[o("div",dt,[o("div",ut,[o("p",pt,d(he.value),1)])])])]),c(C,{name:"fade",appear:""},{default:A(()=>[""!==L.value?(r(),a("div",mt,[o("div",vt,[o("div",gt,d(e.$t("checkout.next_payments"))+": ",1),c(_,{name:"fade-slide",tag:"ul",class:"text-xs space-y-1 text-dark dark:text-white"},{default:A(()=>[(r(!0),a(s,null,l(ne.value,(e,s)=>(r(),a("li",{key:e.id,class:"flex items-center gap-2",style:j({transitionDelay:60*s+"ms"})},[o("span",ht,d(e.name),1),t[3]||(t[3]=o("span",{class:"ml-2"},"—",-1)),o("span",xt,d(e.date),1)],4))),128))]),_:1})])])):p("",!0)]),_:1}),ie.value>0?(r(),a("div",bt,[o("div",yt,[o("div",ft,[o("div",kt,[o("div",wt,[c(u,{keypath:"checkout.upsell_generic",tag:"span"},{default:A(()=>t[4]||(t[4]=[o("span",{class:"font-semibold"},"1",-1)])),_:1,__:[4]})])]),o("span",At," -"+d(ie.value)+"% ",1)])])])):p("",!0)]),n(E).loading?(r(),f(D,{key:0,"expand-padding":!0})):p("",!0)]),o("div",_t,[o("h3",jt,d(e.$t("checkout.payment_method")),1),c(We,{modelValue:L.value,"onUpdate:modelValue":t[1]||(t[1]=e=>L.value=e),disabled:oe.value},null,8,["modelValue","disabled"])]),o("button",{type:"submit",disabled:!oe.value&&!L.value||0===n(z).items.length||de.value&&"crypto"===L.value,class:"checkout-btn w-full py-4 rounded-lg font-normal transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed",onClick:y(xe,["prevent"])},d(e.$t("checkout.submit")),9,Ct)])])):(r(),a("div",Mt,[o("div",Ft,[o("p",{class:"text-center dark:text-gray-100 text-xl mt-5 mb-10",innerHTML:e.$t("checkout.empty")},null,8,Tt),o("div",St,[t[5]||(t[5]=o("div",{class:"h-px flex-1 bg-gray-500 dark:bg-gray-500"},null,-1)),o("div",Ut,d(e.$t("checkout.promocode_empty_hint")),1),t[6]||(t[6]=o("div",{class:"h-px flex-1 bg-gray-500 dark:bg-gray-500"},null,-1))]),o("div",Bt,[o("h3",Dt,d(e.$t("checkout.title")),1),o("div",Gt,[k(o("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>q.value=e),placeholder:e.$t("checkout.promocode_placeholder"),class:i(["flex-1 h-11 px-3 border rounded-l-lg rounded-r-none",K.value?"!border-green-400 !bg-green-400/10":"!border-gray-700 dark:!border-gray-300"]),disabled:K.value},null,10,Zt),[[w,q.value,void 0,{trim:!0}]]),o("button",{class:i(["h-11 w-12 grid place-items-center border border-l-0 rounded-r-lg rounded-l-none transition-all text-white disabled:opacity-50",K.value?"border-red-500 bg-red-500 hover:bg-red-600 dark:border-red-700 dark:bg-red-900 dark:hover:bg-red-800":"border-blue-500 bg-blue-500 hover:bg-blue-600 dark:border-blue-700 dark:bg-blue-900 dark:hover:bg-blue-800"]),disabled:n(E).loading||!K.value&&!q.value,"aria-label":K.value?e.$t("checkout.promocode_clear_aria"):e.$t("checkout.promocode_apply_aria"),onClick:y(ke,["prevent"])},[K.value?(r(),f(n(I),{key:0,class:"w-5 h-5"})):(r(),f(n(N),{key:1,class:"w-5 h-5"}))],10,$t)]),n(E).loading?(r(),f(D,{key:0})):p("",!0)])])]))])}}}),[["__scopeId","data-v-505fddb3"]]);export{Vt as default};
